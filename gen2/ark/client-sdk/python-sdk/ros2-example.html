<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-ark docs-version-current docs-doc-page docs-doc-id-client-sdk/python-sdk/ros2-example" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">ROS2 Example (Advanced Users) | Project Aria Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://facebookresearch.github.io/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-ark-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-ark-current"><meta data-rh="true" property="og:title" content="ROS2 Example (Advanced Users) | Project Aria Docs"><meta data-rh="true" name="description" content="This example demonstrates how to integrate Aria SDK with ROS2 to publish and subscribe to Aria device data using custom ROS2 messages. You&#x27;ll learn how to create custom ROS2 message types, stream Aria sensor data through ROS2 topics, and process the data in subscriber nodes."><meta data-rh="true" property="og:description" content="This example demonstrates how to integrate Aria SDK with ROS2 to publish and subscribe to Aria device data using custom ROS2 messages. You&#x27;ll learn how to create custom ROS2 message types, stream Aria sensor data through ROS2 topics, and process the data in subscriber nodes."><link data-rh="true" rel="icon" href="/projectaria_tools/gen2/img/aria_logo.png"><link data-rh="true" rel="canonical" href="https://facebookresearch.github.io/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example"><link data-rh="true" rel="alternate" href="https://facebookresearch.github.io/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example" hreflang="en"><link data-rh="true" rel="alternate" href="https://facebookresearch.github.io/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ROS2 Example (Advanced Users)","item":"https://facebookresearch.github.io/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q1Q26XCR5N"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q1Q26XCR5N",{})</script>










<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"><link rel="stylesheet" href="/projectaria_tools/gen2/assets/css/styles.d03eb096.css">
<script src="/projectaria_tools/gen2/assets/js/runtime~main.0e152a19.js" defer="defer"></script>
<script src="/projectaria_tools/gen2/assets/js/main.9383c0b2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/projectaria_tools/gen2/"><div class="navbar__logo"><img src="/projectaria_tools/gen2/img/aria_logo.png" alt="aria-research-kit-sdk Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projectaria_tools/gen2/img/aria_logo.png" alt="aria-research-kit-sdk Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Aria Gen 2 Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/projectaria_tools/gen2/ark">Aria Research Kit</a><a class="navbar__item navbar__link" href="/projectaria_tools/gen2/research-tools">Open Science Initiative</a><a class="navbar__item navbar__link" href="/projectaria_tools/gen2/technical-specs">Technical Insights &amp; Specs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.projectaria.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Project Aria<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/facebookresearch/projectaria_tools" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-research-tools-current,docs-ark-current,docs-technical-specs-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/projectaria_tools/gen2/ark"><span title="Aria Research Kit (ARK)" class="linkLabel_WmDU">Aria Research Kit (ARK)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/ark/device/manual"><span title="Aria Gen 2" class="categoryLinkLabel_W154">Aria Gen 2</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/projectaria_tools/gen2/ark/on_device_mp"><span title="On-device Machine Perception" class="linkLabel_WmDU">On-device Machine Perception</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/ark/companion-app/start"><span title="Companion App" class="categoryLinkLabel_W154">Companion App</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/projectaria_tools/gen2/ark/mps"><span title="Machine Perception Services" class="categoryLinkLabel_W154">Machine Perception Services</span></a><button aria-label="Expand sidebar category &#x27;Machine Perception Services&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/projectaria_tools/gen2/ark/client-sdk/start"><span title="Client SDK" class="categoryLinkLabel_W154">Client SDK</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/start"><span title="Get Started" class="linkLabel_WmDU">Get Started</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/recording"><span title="Recording Control" class="linkLabel_WmDU">Recording Control</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/streaming"><span title="Streaming Control" class="linkLabel_WmDU">Streaming Control</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/python-interface"><span title="Program with SDK" class="categoryLinkLabel_W154">Program with SDK</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/python-interface"><span title="Python SDK Examples" class="linkLabel_WmDU">Python SDK Examples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/auth-example"><span title="Authentication Example" class="linkLabel_WmDU">Authentication Example</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/connection-example"><span title="Connection Example" class="linkLabel_WmDU">Connection Example</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/recording-example"><span title="Recording Example" class="linkLabel_WmDU">Recording Example</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/streaming-example"><span title="Streaming Example" class="linkLabel_WmDU">Streaming Example</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/text-to-speech-example"><span title="Text-to-Speech Example" class="linkLabel_WmDU">Text-to-Speech Example</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/ros2-example"><span title="ROS2 Example (Advanced Users)" class="linkLabel_WmDU">ROS2 Example (Advanced Users)</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/remote-streaming"><span title="Remote Streaming" class="linkLabel_WmDU">Remote Streaming</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/ark/client-sdk/changelog"><span title="Changelog" class="linkLabel_WmDU">Changelog</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/ark/vrs_health_check/installation"><span title="Vrs Health Check Tool" class="categoryLinkLabel_W154">Vrs Health Check Tool</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/projectaria_tools/gen2/ark/support"><span title="Support and TroubleShooting" class="categoryLinkLabel_W154">Support and TroubleShooting</span></a><button aria-label="Expand sidebar category &#x27;Support and TroubleShooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/projectaria_tools/gen2/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Client SDK</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Program with SDK</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ROS2 Example (Advanced Users)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ROS2 Integration Example (Advanced Users)</h1></header>
<p>This example demonstrates how to integrate Aria SDK with ROS2 to publish and subscribe to Aria device data using custom ROS2 messages. You&#x27;ll learn how to create custom ROS2 message types, stream Aria sensor data through ROS2 topics, and process the data in subscriber nodes.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>The ROS2 integration allows you to:</p>
<ul>
<li class="">Stream raw Aria sensor data through ROS2 topics</li>
<li class="">Share device calibration data across ROS2 nodes</li>
<li class="">Process sensor data using standard ROS2 tools and workflows</li>
<li class="">Build distributed robotics systems using Aria sensors</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<ul>
<li class="">ROS2 installed (Humble or later)</li>
<li class="">Aria SDK Python package installed</li>
<li class="">Basic familiarity with ROS2 concepts (nodes, topics, messages)</li>
<li class="">C++ compiler for building custom message types</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="setup-steps">Setup Steps<a href="#setup-steps" class="hash-link" aria-label="Direct link to Setup Steps" title="Direct link to Setup Steps" translate="no">​</a></h2>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>ROS2 Environment Setup Required</div><div class="admonitionContent_BuS1"><p>Before proceeding, ensure you have ROS2 properly installed and configured in your development environment. You should have a ROS2 workspace set up (e.g., <code>~/ros2_ws</code>) and be able to source the ROS2 setup files. If you haven&#x27;t set up ROS2 yet, please follow the <a href="https://docs.ros.org/en/humble/Installation.html" target="_blank" rel="noopener noreferrer" class="">ROS2 installation guide</a> for your operating system.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-extract-sdk-examples-and-create-custom-ros2-message-type">Step 1: Extract SDK Examples and Create Custom ROS2 Message Type<a href="#step-1-extract-sdk-examples-and-create-custom-ros2-message-type" class="hash-link" aria-label="Direct link to Step 1: Extract SDK Examples and Create Custom ROS2 Message Type" title="Direct link to Step 1: Extract SDK Examples and Create Custom ROS2 Message Type" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="extract-sdk-example-code">Extract SDK Example Code<a href="#extract-sdk-example-code" class="hash-link" aria-label="Direct link to Extract SDK Example Code" title="Direct link to Extract SDK Example Code" translate="no">​</a></h4>
<p>First, extract the ROS2 example code from the Aria SDK:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -m aria.extract_sdk_samples --out ~/Downloads</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class="">Extracts all SDK example scripts to <code>~/Downloads/projectaria_client_sdk_samples_gen2/</code></li>
<li class="">Includes <code>AriaRaw.msg</code>, <code>ros2_publisher_example.py</code> and <code>ros2_subscriber_example.py</code></li>
<li class="">Also includes other example scripts (device_streaming.py, etc.)</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="understanding-the-custom-message-type">Understanding the Custom Message Type<a href="#understanding-the-custom-message-type" class="hash-link" aria-label="Direct link to Understanding the Custom Message Type" title="Direct link to Understanding the Custom Message Type" translate="no">​</a></h4>
<p><strong>What is AriaRaw?</strong></p>
<p><code>AriaRaw</code> is a custom ROS2 message type specifically designed to transport Aria sensor data through ROS2 topics. Unlike standard ROS2 messages (like <code>sensor_msgs/Image</code> or <code>sensor_msgs/Imu</code>), AriaRaw is a minimal wrapper that carries raw binary sensor data in its native format.</p>
<p><strong>Why do we need a custom message type?</strong></p>
<ol>
<li class="">
<p><strong>Preserves original data format</strong>: Aria devices stream data in FlatBuffer format, which is highly efficient and compact. Using a custom message preserves this efficiency rather than converting to standard ROS2 formats.</p>
</li>
<li class="">
<p><strong>Handles diverse sensor types</strong>: Aria devices have many sensors (4 SLAM cameras, 2 ET cameras, 1 RGB camera, IMU, magnetometer, barometer, etc.). A single flexible message type can carry data from all sensors rather than creating publisher/subscriber pairs for each sensor type.</p>
</li>
<li class="">
<p><strong>Future-proof</strong>: New sensor types or perception outputs (VIO, eye gaze, hand tracking) can be added without changing the ROS2 message interface.</p>
</li>
<li class="">
<p><strong>Maintains timing accuracy</strong>: Raw binary transport ensures nanosecond-precision timestamps aren&#x27;t lost in format conversions.</p>
</li>
</ol>
<p>The subscriber side uses the Aria SDK&#x27;s data converter to decode the raw payload into typed Python objects (NumPy arrays for images, structured data for IMU, etc.).</p>
<hr>
<p><strong>Custom message:</strong> <code>AriaRaw.msg</code></p>
<div class="language-msg codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-msg codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">int64 id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint8[] payload</span><br></span></code></pre></div></div>
<p><strong>Message Fields:</strong></p>
<ul>
<li class=""><code>id</code>: The message type identifier from the Aria SDK (indicates sensor type)</li>
<li class=""><code>payload</code>: Raw binary data containing the sensor information in Flatbuffer format</li>
</ul>
<p>AriaRaw.msg is prepackaged into the example code and can be accessed from</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cat ~/Downloads/projectaria_client_sdk_samples_gen2/AriaRaw.msg</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-custom-message-package">Create the Custom Message Package<a href="#create-the-custom-message-package" class="hash-link" aria-label="Direct link to Create the Custom Message Package" title="Direct link to Create the Custom Message Package" translate="no">​</a></h4>
<p>Follow the <a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Single-Package-Define-And-Use-Interface.html" target="_blank" rel="noopener noreferrer" class="">ROS2 tutorial for creating custom messages</a> to create a C++ package for the custom message definition.</p>
<p><strong>Important: The package MUST be named <code>aria_data_types</code></strong></p>
<p>This exact package name is required because the publisher and subscriber example code import the custom message using:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> aria_data_types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AriaRaw</span><br></span></code></pre></div></div>
<p>If you use a different package name, the example code will fail with import errors.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Build Order</div><div class="admonitionContent_BuS1"><p>Build the <code>aria_data_types</code> message package first before building the Python publisher/subscriber package. The Python package depends on the custom message types being available.</p></div></div>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-create-your-python-ros2-package">Step 2: Create Your Python ROS2 Package<a href="#step-2-create-your-python-ros2-package" class="hash-link" aria-label="Direct link to Step 2: Create Your Python ROS2 Package" title="Direct link to Step 2: Create Your Python ROS2 Package" translate="no">​</a></h3>
<p>Create your own Python ROS2 package for publisher and subscriber nodes following the <a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html" target="_blank" rel="noopener noreferrer" class="">ROS2 Python publisher/subscriber tutorial</a>, then replace the default code with the Aria ROS2 examples.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="replace-publisher-and-subscriber-code">Replace Publisher and Subscriber Code<a href="#replace-publisher-and-subscriber-code" class="hash-link" aria-label="Direct link to Replace Publisher and Subscriber Code" title="Direct link to Replace Publisher and Subscriber Code" translate="no">​</a></h4>
<p>After creating your Python ROS2 package (e.g., <code>py_pubsub</code>) with publisher and subscriber nodes, replace the default code with the Aria ROS2 examples:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Navigate to your ROS2 package</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/ros2_ws/src/py_pubsub/py_pubsub</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copy the ROS2 publisher example</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cp ~/Downloads/projectaria_client_sdk_samples_gen2/ros2_publisher_example.py publisher_member_function.py</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Copy the ROS2 subscriber example</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cp ~/Downloads/projectaria_client_sdk_samples_gen2/ros2_subscriber_example.py subscriber_member_function.py</span><br></span></code></pre></div></div>
<p><strong>Note:</strong> The file names <code>publisher_member_function.py</code> and <code>subscriber_member_function.py</code> should match the entry points defined in your <code>setup.py</code> when you created the package.</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-configure-dependencies">Step 3: Configure Dependencies<a href="#step-3-configure-dependencies" class="hash-link" aria-label="Direct link to Step 3: Configure Dependencies" title="Direct link to Step 3: Configure Dependencies" translate="no">​</a></h3>
<p>Before building, configure the package dependencies to include the custom <code>aria_data_types</code> message package.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="update-packagexml">Update package.xml<a href="#update-packagexml" class="hash-link" aria-label="Direct link to Update package.xml" title="Direct link to Update package.xml" translate="no">​</a></h4>
<p>Edit the <code>package.xml</code> file in your <code>py_pubsub</code> package to add the dependency on <code>aria_data_types</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/ros2_ws/src/py_pubsub</span><br></span></code></pre></div></div>
<p>Add the following line to <code>package.xml</code> in the dependencies section:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">exec_depend</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">aria_data_types</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">exec_depend</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre></div></div>
<p><strong>Why this is needed:</strong></p>
<ul>
<li class="">Declares that <code>py_pubsub</code> depends on the <code>aria_data_types</code> message package</li>
<li class="">Ensures ROS2 can find the custom <code>AriaRaw</code> message type at runtime</li>
<li class="">Without this dependency, the nodes will fail to import the custom message</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-build-and-run-the-example">Step 4: Build and Run the Example<a href="#step-4-build-and-run-the-example" class="hash-link" aria-label="Direct link to Step 4: Build and Run the Example" title="Direct link to Step 4: Build and Run the Example" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="build-the-python-package">Build the Python Package<a href="#build-the-python-package" class="hash-link" aria-label="Direct link to Build the Python Package" title="Direct link to Build the Python Package" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Return to workspace root</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/ros2_ws</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Build the package</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">colcon build --packages-select py_pubsub</span><br></span></code></pre></div></div>
<p>This compiles the package and prepares it for execution.</p>
<hr>
<p>Now that the packages are built, you can run the publisher and subscriber nodes to stream and process Aria sensor data.</p>
<p><strong>Important:</strong> Before running the nodes, ensure both terminals use the same ROS_DOMAIN_ID so they can communicate with each other:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export ROS_DOMAIN_ID=0</span><br></span></code></pre></div></div>
<p>Add this command to both terminals before running the nodes. This ensures the publisher and subscriber are on the same ROS2 domain and can discover each other.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="run-the-talker-publisher">Run the Talker (Publisher)<a href="#run-the-talker-publisher" class="hash-link" aria-label="Direct link to Run the Talker (Publisher)" title="Direct link to Run the Talker (Publisher)" translate="no">​</a></h4>
<p>In another terminal, start the talker:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source install/setup.bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 run py_pubsub talker</span><br></span></code></pre></div></div>
<p><strong>What happens:</strong></p>
<ul>
<li class="">Connects to Aria device via USB</li>
<li class="">Starts streaming sensor data</li>
<li class="">Publishes calibration and raw sensor messages to ROS2 topics</li>
<li class="">Subscriber receives and processes the data</li>
</ul>
<p><strong>Example Publisher Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[INFO] [1746238590305.2341235] [minimal_publisher]: Received message: ID=SLAM_CAMERA_FRAME, payload length=114353</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[INFO] [1746238590315.4567890] [minimal_publisher]: Received message: ID=IMU_EVENT, payload length=4896</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[INFO] [1746238590335.1234567] [minimal_publisher]: Received message: ID=MP_VIO_RESULT, payload length=2048</span><br></span></code></pre></div></div>
<p><strong>Log Explanation:</strong></p>
<ul>
<li class=""><strong>Payload length</strong>: Size of the raw sensor data in bytes</li>
<li class="">Messages are logged as they arrive from the Aria device and published to ROS2</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="run-the-listener-subscriber">Run the Listener (Subscriber)<a href="#run-the-listener-subscriber" class="hash-link" aria-label="Direct link to Run the Listener (Subscriber)" title="Direct link to Run the Listener (Subscriber)" translate="no">​</a></h4>
<p>In one terminal, start the listener:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">source install/setup.bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 run py_pubsub listener</span><br></span></code></pre></div></div>
<p><strong>What happens:</strong></p>
<ul>
<li class="">Subscriber node starts and waits for messages</li>
<li class="">Listens on <code>aria_raw_message</code> and <code>calibration</code> topics</li>
<li class="">Will begin processing data once publisher starts</li>
</ul>
<p><strong>Example Listener Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Calibration] Received device calibration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Calibration] Calibration set in converter - VIO, eye gaze, and hand pose decoding enabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[IMU] Accel: [9.594, 2.151, 0.401] m/s², Gyro: [-0.001, 0.003, 0.002] rad/s, Timestamp: 5045688456090 ns, Count: 16 samples</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[SLAM Camera] Size: 512x512, Timestamp: 5046068223788 ns, Camera ID: 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[VIO] timestamp 5048468222100 with transform_odometry_bodyimu: [[-2.9847002e-01 -1.5660522e+00  6.5189652e-04]] and [[ 0.00011986 -0.00025058  0.00013689]] ns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[RGB Camera] Size: 2016x1512, Timestamp: 5048213203431 ns, Camera ID: 64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[IMU] Accel: [9.601, 2.148, 0.405] m/s², Gyro: [-0.002, 0.002, 0.001] rad/s, Timestamp: 5045788456090 ns, Count: 16 samples</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[SLAM Camera] Size: 512x512, Timestamp: 5046168223788 ns, Camera ID: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Eye Gaze] Yaw: 0.124 rad, Pitch: -0.056 rad, Depth: 1.234 m, Timestamp: 5048.468 s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Hand Tracking] Left hand: detected, Right hand: not detected, Timestamp: 5048.512 s</span><br></span></code></pre></div></div>
<p><strong>Output Explanation:</strong></p>
<ul>
<li class=""><strong>Calibration</strong>: First message received, enables VIO/eye gaze/hand tracking conversion</li>
<li class=""><strong>IMU</strong>: High-frequency accelerometer (m/s²) and gyroscope (rad/s) measurements</li>
<li class=""><strong>SLAM Camera</strong>: Monochrome tracking camera frames with Camera ID (4 cameras total)</li>
<li class=""><strong>RGB Camera</strong>: Color camera frames at high resolution</li>
<li class=""><strong>VIO</strong>: Visual-Inertial Odometry with rotation (log space) and translation vectors</li>
<li class=""><strong>Eye Gaze</strong>: Gaze direction in yaw/pitch angles and focus depth</li>
<li class=""><strong>Hand Tracking</strong>: Hand detection status for left and right hands</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="code-walkthrough">Code Walkthrough<a href="#code-walkthrough" class="hash-link" aria-label="Direct link to Code Walkthrough" title="Direct link to Code Walkthrough" translate="no">​</a></h2>
<p>This section provides a detailed explanation of how the publisher and subscriber code works.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="publisher-code-explanation">Publisher Code Explanation<a href="#publisher-code-explanation" class="hash-link" aria-label="Direct link to Publisher Code Explanation" title="Direct link to Publisher Code Explanation" translate="no">​</a></h3>
<p>The publisher node connects to an Aria device, receives streaming data, and publishes it to ROS2 topics.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-import-required-modules">1. Import Required Modules<a href="#1-import-required-modules" class="hash-link" aria-label="Direct link to 1. Import Required Modules" title="Direct link to 1. Import Required Modules" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> aria</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sdk_gen2 </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> sdk_gen2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> aria</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">stream_receiver </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> receiver</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> rclpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> aria_data_types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AriaRaw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> projectaria_tools</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> calibration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">node </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> std_msgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> String</span><br></span></code></pre></div></div>
<p><strong>What these imports do:</strong></p>
<ul>
<li class=""><code>aria.sdk_gen2</code>: Core SDK for device connection and configuration</li>
<li class=""><code>aria.stream_receiver</code>: Receives streaming data from Aria device over HTTP</li>
<li class=""><code>rclpy</code>: ROS2 Python client library</li>
<li class=""><code>aria_data_types.msg.AriaRaw</code>: Custom ROS2 message type for raw sensor data</li>
<li class=""><code>projectaria_tools.core.calibration</code>: Tools for working with device calibration</li>
<li class=""><code>std_msgs.msg.String</code>: Standard ROS2 string message for calibration data</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-setup-device-streaming-function">2. Setup Device Streaming Function<a href="#2-setup-device-streaming-function" class="hash-link" aria-label="Direct link to 2. Setup Device Streaming Function" title="Direct link to 2. Setup Device Streaming Function" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">device_streaming</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Set up the device client config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">DeviceClientConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device_client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_client_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> device_client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Set streaming config with profile name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    streaming_config </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HttpStreamingConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    streaming_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">profile_name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;profile9&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    streaming_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">streaming_interface </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamingInterface</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">USB_NCM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_streaming_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">streaming_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Start streaming</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">start_streaming</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> device</span><br></span></code></pre></div></div>
<p><strong>What this function does:</strong></p>
<ul>
<li class=""><strong>Connects to Aria device</strong> via USB (first available device if not specified)</li>
<li class=""><strong>Configures streaming profile</strong> (&quot;profile9&quot; - a predefined sensor configuration)</li>
<li class=""><strong>Sets interface to USB_NCM</strong> (Network Control Model for USB communication)</li>
<li class=""><strong>Starts streaming</strong> and returns the device handle</li>
</ul>
<p><strong>Streaming Profiles:</strong> Different profiles capture different combinations of sensors (cameras, IMU, etc.) at varying frequencies.</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-minimalpublisher-class---initialization">3. MinimalPublisher Class - Initialization<a href="#3-minimalpublisher-class---initialization" class="hash-link" aria-label="Direct link to 3. MinimalPublisher Class - Initialization" title="Direct link to 3. MinimalPublisher Class - Initialization" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MinimalPublisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;minimal_publisher&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">event_pub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_publisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">AriaRaw</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;aria_raw_message&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timer_pub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_publisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;calibration&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timer_period </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 10 Hz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_timer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timer_period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_publisher_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_msg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">setup_streaming_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What happens during initialization:</strong></p>
<ul>
<li class=""><strong>Creates ROS2 node</strong> named &quot;minimal_publisher&quot;</li>
<li class=""><strong>Creates two publishers:</strong>
<ul>
<li class=""><code>event_pub</code>: Publishes raw sensor data on topic <code>aria_raw_message</code> (queue size: 1000)</li>
<li class=""><code>timer_pub</code>: Publishes calibration on topic <code>calibration</code> (queue size: 100)</li>
</ul>
</li>
<li class=""><strong>Sets up periodic timer</strong> at 10 Hz to republish calibration data</li>
<li class=""><strong>Initializes calibration message</strong> as <code>None</code> (will be set when received from device)</li>
<li class=""><strong>Sets up streaming receiver</strong> to receive data from Aria device</li>
</ul>
<p><strong>Why publish calibration periodically?</strong> Ensures late-joining subscribers receive calibration data needed to decode sensor messages.</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-calibration-publisher-callback">4. Calibration Publisher Callback<a href="#4-calibration-publisher-callback" class="hash-link" aria-label="Direct link to 4. Calibration Publisher Callback" title="Direct link to 4. Calibration Publisher Callback" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">calib_publisher_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># publish calibration periodically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_msg </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timer_pub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">publish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Published calibration on periodic_topic: /calibration&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Runs every 100ms</strong> (10 Hz) via timer</li>
<li class=""><strong>Checks if calibration received</strong> from device</li>
<li class=""><strong>Publishes calibration</strong> to <code>/calibration</code> topic if available</li>
<li class=""><strong>Logs publication</strong> for debugging</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-device-calibration-callback">5. Device Calibration Callback<a href="#5-device-calibration-callback" class="hash-link" aria-label="Direct link to 5. Device Calibration Callback" title="Direct link to 5. Device Calibration Callback" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">stream_receiver_device_calib_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> device_calib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set the calibration message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_msg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> calibration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">device_calibration_to_json_string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        device_calib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Called once</strong> when device sends calibration data (usually on first connection)</li>
<li class=""><strong>Converts calibration object to JSON string</strong> using ProjectAria tools</li>
<li class=""><strong>Stores in ROS2 String message</strong> for publishing</li>
</ul>
<p><strong>Calibration data includes:</strong> Camera intrinsics/extrinsics, IMU calibration, sensor-to-sensor transformations</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-raw-message-callback">6. Raw Message Callback<a href="#6-raw-message-callback" class="hash-link" aria-label="Direct link to 6. Raw Message Callback" title="Direct link to 6. Raw Message Callback" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">stream_receiver_raw_message_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> offset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ros2_msg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AriaRaw</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ros2_msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ros2_msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">payload </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">as_memoryview</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">event_pub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">publish</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ros2_msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Received and published message: ID=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">sdk_gen2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">MessageType</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">to_string</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">ros2_msg</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation builtin" style="color:rgb(130, 170, 255)">id</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, payload length=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(130, 170, 255)">len</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">ros2_msg</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">payload</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Called for every sensor message</strong> from device (images, IMU, etc.)</li>
<li class=""><strong>Creates AriaRaw ROS2 message</strong> with message ID and payload</li>
<li class=""><strong>Converts payload to memoryview</strong> for efficient data transfer</li>
<li class=""><strong>Publishes to aria_raw_message topic</strong></li>
<li class=""><strong>Logs message type and size</strong> using message ID lookup</li>
</ul>
<p><strong>Message IDs:</strong> Each sensor has a unique ID (e.g., <code>0x8010</code> = SLAM camera, <code>0x8020</code> = IMU)</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-setup-streaming-receiver">7. Setup Streaming Receiver<a href="#7-setup-streaming-receiver" class="hash-link" aria-label="Direct link to 7. Setup Streaming Receiver" title="Direct link to 7. Setup Streaming Receiver" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">setup_streaming_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># setup the server to receive streaming data from the device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HttpServerConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">address </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.0.0.0&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Listen on all interfaces</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">port </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6768</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># setup the receiver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stream_receiver </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamReceiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        enable_image_decoding</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> enable_raw_stream</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stream_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_server_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># register callbacks for each type of data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stream_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">register_device_calib_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">stream_receiver_device_calib_callback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stream_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">register_raw_message_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">stream_receiver_raw_message_callback</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># start the server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stream_receiver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">start_server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Creates HTTP server</strong> listening on port 6768 (all network interfaces)</li>
<li class=""><strong>Enables image decoding</strong> for camera frames</li>
<li class=""><strong>Enables raw stream</strong> to receive all message types</li>
<li class=""><strong>Registers callbacks:</strong>
<ul>
<li class="">Device calibration → <code>stream_receiver_device_calib_callback</code></li>
<li class="">Raw messages → <code>stream_receiver_raw_message_callback</code></li>
</ul>
</li>
<li class=""><strong>Starts server</strong> to begin receiving data from device</li>
</ul>
<p><strong>Data flow:</strong> Aria device → HTTP POST to localhost:6768 → Callbacks triggered → Data published to ROS2</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-main-function">8. Main Function<a href="#8-main-function" class="hash-link" aria-label="Direct link to 8. Main Function" title="Direct link to 8. Main Function" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    device </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> device_streaming</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minimal_publisher </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> MinimalPublisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">spin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">minimal_publisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minimal_publisher</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">destroy_node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">shutdown</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>Execution order:</strong></p>
<ol>
<li class=""><strong>Initialize ROS2</strong> Python client library</li>
<li class=""><strong>Connect to device and start streaming</strong> via <code>device_streaming()</code></li>
<li class=""><strong>Create publisher node</strong> which sets up HTTP server</li>
<li class=""><strong>Spin node</strong> - keeps node running and processing callbacks</li>
<li class=""><strong>Cleanup</strong> when interrupted (Ctrl+C)</li>
</ol>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="subscriber-code-explanation">Subscriber Code Explanation<a href="#subscriber-code-explanation" class="hash-link" aria-label="Direct link to Subscriber Code Explanation" title="Direct link to Subscriber Code Explanation" translate="no">​</a></h3>
<p>The subscriber node receives sensor data from ROS2 topics, converts raw messages to typed data, and processes them.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-import-required-modules-1">1. Import Required Modules<a href="#1-import-required-modules-1" class="hash-link" aria-label="Direct link to 1. Import Required Modules" title="Direct link to 1. Import Required Modules" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> aria</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">oss_data_converter </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> data_converter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> aria</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sdk_gen2 </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> sdk_gen2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> rclpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> aria_data_types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AriaRaw</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">node </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> std_msgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> String</span><br></span></code></pre></div></div>
<p><strong>What these imports do:</strong></p>
<ul>
<li class=""><code>aria.oss_data_converter</code>: Converts raw flatbuffer messages to Python objects</li>
<li class=""><code>aria.sdk_gen2</code>: SDK for message type constants</li>
<li class="">Other imports same as publisher</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-setup-data-converter-and-global-state">2. Setup Data Converter and Global State<a href="#2-setup-data-converter-and-global-state" class="hash-link" aria-label="Direct link to 2. Setup Data Converter and Global State" title="Direct link to 2. Setup Data Converter and Global State" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">converter </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data_converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">OssDataConverter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">calibration_received </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Creates converter instance</strong> to decode raw sensor data</li>
<li class=""><strong>Tracks calibration state</strong> - must receive calibration before processing VIO/eye gaze/hand tracking</li>
</ul>
<p><strong>Why global?</strong> Shared between callback functions to coordinate calibration state</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-raw-message-processing-function">3. Raw Message Processing Function<a href="#3-raw-message-processing-function" class="hash-link" aria-label="Direct link to 3. Raw Message Processing Function" title="Direct link to 3. Raw Message Processing Function" translate="no">​</a></h4>
<p>The <code>raw_message_callback</code> function is the core processing logic. It handles different message types:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">raw_message_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">raw_message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AriaRaw</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> raw_message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">payload </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;No payload received, cannot decode this message&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SharedMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">raw_message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> raw_message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> raw_message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">id</span><br></span></code></pre></div></div>
<p><strong>Initial processing:</strong></p>
<ul>
<li class=""><strong>Checks for valid payload</strong> (some message types may have empty payloads)</li>
<li class=""><strong>Reconstructs SharedMessage</strong> from ROS2 AriaRaw message</li>
<li class=""><strong>Extracts message ID</strong> for type checking</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-image-data-processing">4. Image Data Processing<a href="#4-image-data-processing" class="hash-link" aria-label="Direct link to 4. Image Data Processing" title="Direct link to 4. Image Data Processing" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SLAM_CAMERA_FRAME</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    image_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> image_record </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_image_data_and_record</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> image_data </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;[SLAM Camera] Size: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">image_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">get_width</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">x</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">image_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">get_height</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Timestamp: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">image_record</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">capture_timestamp_ns</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)"> ns, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Camera ID: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">image_record</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">camera_id</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>Handles three camera types:</strong></p>
<ul>
<li class=""><strong>SLAM cameras</strong> (4 monochrome tracking cameras at 512x512)</li>
<li class=""><strong>ET cameras</strong> (2 eye-tracking cameras)</li>
<li class=""><strong>POV/RGB camera</strong> (single color camera at 2016x1512)</li>
</ul>
<p><strong>Conversion result:</strong></p>
<ul>
<li class=""><code>image_data</code>: NumPy array with pixel data</li>
<li class=""><code>image_record</code>: Metadata (timestamp, camera ID, exposure, etc.)</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-imu-data-processing">5. IMU Data Processing<a href="#5-imu-data-processing" class="hash-link" aria-label="Direct link to 5. IMU Data Processing" title="Direct link to 5. IMU Data Processing" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">IMU_EVENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    imu_data_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_imu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> imu_data_list </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">imu_data_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        imu_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> imu_data_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;[IMU] Accel: [</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">accel_msec2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">0</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">accel_msec2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">1</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">accel_msec2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">] m/s², &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Gyro: [</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">gyro_radsec</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">0</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">gyro_radsec</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">1</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">gyro_radsec</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">2</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">] rad/s, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Timestamp: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">imu_data</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">capture_timestamp_ns</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)"> ns, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Count: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(130, 170, 255)">len</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">imu_data_list</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)"> samples&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>IMU messages contain:</strong></p>
<ul>
<li class=""><strong>Accelerometer data</strong> in m/s² (3-axis)</li>
<li class=""><strong>Gyroscope data</strong> in rad/s (3-axis)</li>
<li class=""><strong>Multiple samples</strong> per message (batched for efficiency)</li>
<li class=""><strong>High frequency:</strong> ~1kHz sampling rate</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-other-sensor-types">6. Other Sensor Types<a href="#6-other-sensor-types" class="hash-link" aria-label="Direct link to 6. Other Sensor Types" title="Direct link to 6. Other Sensor Types" translate="no">​</a></h4>
<p>The callback also handles:</p>
<p><strong>Environmental sensors:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Barometer - atmospheric pressure and temperature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">BARO_EVENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    baro_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_barometer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pressure in Pascals, temperature in Celsius</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Magnetometer - magnetic field</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MAG_EVENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mag_data_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_magnetometer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># magnetic field in Tesla (3-axis)</span><br></span></code></pre></div></div>
<p><strong>Location sensors:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># GNSS - GPS position data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GNSS_EVENT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gnss_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_gnss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># latitude, longitude, altitude, accuracy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Phone location - companion phone position</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">PHONE_LOCATION_DATA</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    phone_location </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_phone_location</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>Perception outputs:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Eye gaze - where user is looking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MP_ET_RESULT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    eyegaze_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_eye_gaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># yaw, pitch angles and depth</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Hand tracking - hand pose detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MP_HT_RESULT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    handtracking_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_hand_pose</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># left/right hand detection and pose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># VIO - visual-inertial odometry (device pose)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MP_VIO_RESULT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vio_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_vio_result</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 6-DOF pose (rotation + translation)</span><br></span></code></pre></div></div>
<p><strong>Wireless beacons:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Bluetooth beacons</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">BLE_BEACONS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ble_beacons </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_bluetooth_beacon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># WiFi access points</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">elif</span><span class="token plain"> message_id </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> sdk_gen2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">MessageType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">WIFI_BEACONS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    wifi_beacons </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_wifi_beacon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-minimalsubscriber-class">7. MinimalSubscriber Class<a href="#7-minimalsubscriber-class" class="hash-link" aria-label="Direct link to 7. MinimalSubscriber Class" title="Direct link to 7. MinimalSubscriber Class" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MinimalSubscriber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;minimal_subscriber&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">subscription </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_subscription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            AriaRaw</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;aria_raw_message&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">listener_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_sub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_subscription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;calibration&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">calib_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What happens during initialization:</strong></p>
<ul>
<li class=""><strong>Creates ROS2 node</strong> named &quot;minimal_subscriber&quot;</li>
<li class=""><strong>Subscribes to two topics:</strong>
<ul>
<li class=""><code>aria_raw_message</code>: Raw sensor data (queue size: 10)</li>
<li class=""><code>calibration</code>: Device calibration (queue size: 10)</li>
</ul>
</li>
<li class=""><strong>Registers callbacks</strong> for each topic</li>
</ul>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-listener-callback">8. Listener Callback<a href="#8-listener-callback" class="hash-link" aria-label="Direct link to 8. Listener Callback" title="Direct link to 8. Listener Callback" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">listener_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> calibration_received</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        raw_message_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Called for each AriaRaw message</strong> received from publisher</li>
<li class=""><strong>Waits for calibration</strong> before processing (required for VIO/eye gaze/hand tracking)</li>
<li class=""><strong>Delegates to raw_message_callback</strong> for actual processing</li>
</ul>
<p><strong>Why wait for calibration?</strong> Some conversions (VIO, eye gaze, hand pose) require calibration data to properly transform coordinates.</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="9-calibration-callback">9. Calibration Callback<a href="#9-calibration-callback" class="hash-link" aria-label="Direct link to 9. Calibration Callback" title="Direct link to 9. Calibration Callback" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">calib_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">global</span><span class="token plain"> calibration_received</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;[Calibration] Received device calibration&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_calibration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    calibration_received </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;[Calibration] Calibration set in converter - VIO, eye gaze, and hand pose decoding enabled&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>What this does:</strong></p>
<ul>
<li class=""><strong>Receives calibration JSON string</strong> from publisher</li>
<li class=""><strong>Sets calibration in converter</strong> - required for coordinate transformations</li>
<li class=""><strong>Updates global flag</strong> to enable message processing</li>
<li class=""><strong>Logs confirmation</strong> that calibration is ready</li>
</ul>
<p><strong>This runs once</strong> (usually) when subscriber first starts or when late-joining</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="10-main-function">10. Main Function<a href="#10-main-function" class="hash-link" aria-label="Direct link to 10. Main Function" title="Direct link to 10. Main Function" translate="no">​</a></h4>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minimal_subscriber </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> MinimalSubscriber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">spin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">minimal_subscriber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    minimal_subscriber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">destroy_node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">shutdown</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p><strong>Execution flow:</strong></p>
<ol>
<li class=""><strong>Initialize ROS2</strong> Python client library</li>
<li class=""><strong>Create subscriber node</strong> and register topic subscriptions</li>
<li class=""><strong>Spin node</strong> - processes incoming messages via callbacks</li>
<li class=""><strong>Cleanup</strong> when interrupted</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="data-flow">Data Flow<a href="#data-flow" class="hash-link" aria-label="Direct link to Data Flow" title="Direct link to Data Flow" translate="no">​</a></h2>
<ol>
<li class=""><strong>Publisher</strong> connects to Aria device and starts streaming</li>
<li class="">Device sends calibration data → <strong>Publisher</strong> publishes to <code>calibration</code> topic</li>
<li class=""><strong>Subscriber</strong> receives calibration → Sets up data converter</li>
<li class="">Device sends sensor data → <strong>Publisher</strong> receives via HTTP server</li>
<li class=""><strong>Publisher</strong> converts to ROS2 messages   → Publishes to <code>aria_raw_message</code> topic</li>
<li class=""><strong>Subscriber</strong> receives messages → Converts to typed data → Processes/displays</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="no-data-in-subscriber">No Data in Subscriber<a href="#no-data-in-subscriber" class="hash-link" aria-label="Direct link to No Data in Subscriber" title="Direct link to No Data in Subscriber" translate="no">​</a></h3>
<p><strong>Problem:</strong> Subscriber node runs but receives no messages.</p>
<p><strong>Solutions:</strong></p>
<ol>
<li class="">
<p><strong>Check publisher is running:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 node list</span><br></span></code></pre></div></div>
<p>Should show both <code>minimal_publisher</code> and <code>minimal_subscriber</code></p>
</li>
<li class="">
<p><strong>Check topics:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 topic list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 topic echo /aria_raw_message</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Verify Aria device connection:</strong></p>
<ul>
<li class="">Ensure device is connected via USB</li>
<li class="">Check device is streaming (check publisher logs)</li>
</ul>
</li>
</ol>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="port-6768-already-in-use">Port 6768 Already in Use<a href="#port-6768-already-in-use" class="hash-link" aria-label="Direct link to Port 6768 Already in Use" title="Direct link to Port 6768 Already in Use" translate="no">​</a></h3>
<p><strong>Problem:</strong> Publisher fails to start HTTP server.</p>
<p><strong>Solutions:</strong></p>
<ol>
<li class="">
<p><strong>Check what&#x27;s using the port:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo lsof -i :6768</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Kill existing process:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kill -9 &lt;PID&gt;</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Or change port in code:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">port </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6769</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Use different port</span><br></span></code></pre></div></div>
</li>
</ol>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="subscriber-not-processing-messages">Subscriber Not Processing Messages<a href="#subscriber-not-processing-messages" class="hash-link" aria-label="Direct link to Subscriber Not Processing Messages" title="Direct link to Subscriber Not Processing Messages" translate="no">​</a></h3>
<p><strong>Problem:</strong> Subscriber receives messages but doesn&#x27;t process them.</p>
<p><strong>Reason:</strong> Calibration not received yet. The subscriber waits for calibration before processing sensor data.</p>
<p><strong>Solution:</strong> Ensure publisher successfully connects to device and sends calibration. Check publisher logs for calibration callback.</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="high-message-drop-rate">High Message Drop Rate<a href="#high-message-drop-rate" class="hash-link" aria-label="Direct link to High Message Drop Rate" title="Direct link to High Message Drop Rate" translate="no">​</a></h3>
<p><strong>Problem:</strong> Some messages not being received.</p>
<p><strong>Solutions:</strong></p>
<ul>
<li class=""><strong>Increase queue sizes</strong> in publisher/subscriber</li>
<li class=""><strong>Check network bandwidth</strong> if using WiFi</li>
<li class=""><strong>Reduce callback processing time</strong></li>
<li class=""><strong>Use wired USB connection</strong> instead of wireless</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="publisher-and-subscriber-cannot-communicate">Publisher and Subscriber Cannot Communicate<a href="#publisher-and-subscriber-cannot-communicate" class="hash-link" aria-label="Direct link to Publisher and Subscriber Cannot Communicate" title="Direct link to Publisher and Subscriber Cannot Communicate" translate="no">​</a></h3>
<p><strong>Problem:</strong> Publisher and subscriber are running but not communicating (subscriber receives no messages).</p>
<p><strong>Reason:</strong> ROS2 nodes can only communicate if they&#x27;re using the same ROS_DOMAIN_ID. By default, ROS2 uses domain ID 0, but if you have multiple ROS2 systems on the same network or have previously set a different domain ID, they may not be able to see each other.</p>
<p><strong>Solution:</strong> Ensure both terminals use the same ROS_DOMAIN_ID:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Terminal 1 (Subscriber)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export ROS_DOMAIN_ID=0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source install/setup.bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 run py_pubsub listener</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Terminal 2 (Publisher)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export ROS_DOMAIN_ID=0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source install/setup.bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 run py_pubsub talker</span><br></span></code></pre></div></div>
<p><strong>Check current domain ID:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo $ROS_DOMAIN_ID</span><br></span></code></pre></div></div>
<p><strong>Verify nodes can see each other:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 node list</span><br></span></code></pre></div></div>
<p>Should show both <code>minimal_publisher</code> and <code>minimal_subscriber</code>.</p>
<p><strong>Note:</strong> ROS_DOMAIN_ID can be any value from 0 to 101. Use different IDs to isolate different ROS2 systems on the same network.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="related-resources">Related Resources<a href="#related-resources" class="hash-link" aria-label="Direct link to Related Resources" title="Direct link to Related Resources" translate="no">​</a></h2>
<ul>
<li class=""><a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Single-Package-Define-And-Use-Interface.html" target="_blank" rel="noopener noreferrer" class="">ROS2 Custom Messages Tutorial</a></li>
<li class=""><a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html" target="_blank" rel="noopener noreferrer" class="">ROS2 Python Publisher/Subscriber Tutorial</a></li>
<li class=""><a class="" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/streaming-example">Streaming Example</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://www.internalfb.com/code/fbsource/arvr/projects/ariane/aria_research_kit/projectaria_tools/website/docs-ark/client-sdk/python-sdk/ros2-example.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/projectaria_tools/gen2/ark/client-sdk/python-sdk/text-to-speech-example"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Text-to-Speech Example</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/projectaria_tools/gen2/ark/client-sdk/remote-streaming"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Remote Streaming</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#setup-steps" class="table-of-contents__link toc-highlight">Setup Steps</a><ul><li><a href="#step-1-extract-sdk-examples-and-create-custom-ros2-message-type" class="table-of-contents__link toc-highlight">Step 1: Extract SDK Examples and Create Custom ROS2 Message Type</a></li><li><a href="#step-2-create-your-python-ros2-package" class="table-of-contents__link toc-highlight">Step 2: Create Your Python ROS2 Package</a></li><li><a href="#step-3-configure-dependencies" class="table-of-contents__link toc-highlight">Step 3: Configure Dependencies</a></li><li><a href="#step-4-build-and-run-the-example" class="table-of-contents__link toc-highlight">Step 4: Build and Run the Example</a></li></ul></li><li><a href="#code-walkthrough" class="table-of-contents__link toc-highlight">Code Walkthrough</a><ul><li><a href="#publisher-code-explanation" class="table-of-contents__link toc-highlight">Publisher Code Explanation</a></li><li><a href="#subscriber-code-explanation" class="table-of-contents__link toc-highlight">Subscriber Code Explanation</a></li></ul></li><li><a href="#data-flow" class="table-of-contents__link toc-highlight">Data Flow</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#no-data-in-subscriber" class="table-of-contents__link toc-highlight">No Data in Subscriber</a></li><li><a href="#port-6768-already-in-use" class="table-of-contents__link toc-highlight">Port 6768 Already in Use</a></li><li><a href="#subscriber-not-processing-messages" class="table-of-contents__link toc-highlight">Subscriber Not Processing Messages</a></li><li><a href="#high-message-drop-rate" class="table-of-contents__link toc-highlight">High Message Drop Rate</a></li><li><a href="#publisher-and-subscriber-cannot-communicate" class="table-of-contents__link toc-highlight">Publisher and Subscriber Cannot Communicate</a></li></ul></li><li><a href="#related-resources" class="table-of-contents__link toc-highlight">Related Resources</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.projectaria.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Introducing Project Aria<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/projectaria_tools/gen2/">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/projectaria_tools/gen2/ark/support">Get Support</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Participate</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.projectaria.com/datasets/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Datasets<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.projectaria.com/challenges/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Challenges<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.projectaria.com/research-kit/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partner Program<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Responsible Innovation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://about.facebook.com/realitylabs/responsible-innovation-principles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Innovation Principles<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://about.facebook.com/realitylabs/projectaria/community-guidelines/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project Aria Research Community Guidelines<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.fb.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/projectaria_tools/gen2/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projectaria_tools/gen2/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2026 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>