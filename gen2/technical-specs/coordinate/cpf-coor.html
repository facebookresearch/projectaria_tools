<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-technical-specs docs-version-current docs-doc-page docs-doc-id-coordinate/cpf-coor" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Central Pupil Frame (CPF) in Aria and `projectaria-tools` | Project Aria Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://facebookresearch.github.io/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-technical-specs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-technical-specs-current"><meta data-rh="true" property="og:title" content="Central Pupil Frame (CPF) in Aria and `projectaria-tools` | Project Aria Docs"><meta data-rh="true" name="description" content="What is Central Pupil Frame?"><meta data-rh="true" property="og:description" content="What is Central Pupil Frame?"><link data-rh="true" rel="icon" href="/projectaria_tools/gen2/img/aria_logo.png"><link data-rh="true" rel="canonical" href="https://facebookresearch.github.io/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor"><link data-rh="true" rel="alternate" href="https://facebookresearch.github.io/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor" hreflang="en"><link data-rh="true" rel="alternate" href="https://facebookresearch.github.io/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Central Pupil Frame (CPF) in Aria and `projectaria-tools`","item":"https://facebookresearch.github.io/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q1Q26XCR5N"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Q1Q26XCR5N",{})</script>










<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"><link rel="stylesheet" href="/projectaria_tools/gen2/assets/css/styles.c35ebb64.css">
<script src="/projectaria_tools/gen2/assets/js/runtime~main.953c9b22.js" defer="defer"></script>
<script src="/projectaria_tools/gen2/assets/js/main.5d43c26d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/projectaria_tools/gen2/"><div class="navbar__logo"><img src="/projectaria_tools/gen2/img/aria_logo.png" alt="aria-research-kit-sdk Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projectaria_tools/gen2/img/aria_logo.png" alt="aria-research-kit-sdk Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Aria Gen 2 Docs</b></a><a class="navbar__item navbar__link" href="/projectaria_tools/gen2/ark">Aria Research Kit</a><a class="navbar__item navbar__link" href="/projectaria_tools/gen2/research-tools">Open Science Initiative</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/projectaria_tools/gen2/technical-specs">Technical Insights &amp; Specs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://www.projectaria.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Project Aria<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/facebookresearch/projectaria_tools" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-research-tools-current,docs-ark-current,docs-technical-specs-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/projectaria_tools/gen2/technical-specs"><span title="Technical Specifications" class="linkLabel_WmDU">Technical Specifications</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/technical-specs/device/hardware"><span title="Aria Gen2 Device" class="categoryLinkLabel_W154">Aria Gen2 Device</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/technical-specs/vrs/data-format"><span title="VRS Format" class="categoryLinkLabel_W154">VRS Format</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/technical-specs/client-sdk/cli"><span title="Client SDK" class="categoryLinkLabel_W154">Client SDK</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/projectaria_tools/gen2/technical-specs/mps/mps_cli_guide"><span title="Machine Perception Services" class="categoryLinkLabel_W154">Machine Perception Services</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/projectaria_tools/gen2/technical-specs/coordinate/2d-coor"><span title="Coordinate Conventions" class="categoryLinkLabel_W154">Coordinate Conventions</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/technical-specs/coordinate/2d-coor"><span title="2D Image Coordinate System Conventions" class="linkLabel_WmDU">2D Image Coordinate System Conventions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/projectaria_tools/gen2/technical-specs/coordinate/3d-coor"><span title="3D Coordinate Frame Conventions" class="linkLabel_WmDU">3D Coordinate Frame Conventions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/projectaria_tools/gen2/technical-specs/coordinate/cpf-coor"><span title="Central Pupil Frame (CPF) in Aria and `projectaria-tools`" class="linkLabel_WmDU">Central Pupil Frame (CPF) in Aria and `projectaria-tools`</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/projectaria_tools/gen2/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Coordinate Conventions</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Central Pupil Frame (CPF) in Aria and `projectaria-tools`</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Central Pupil Frame (CPF) in Aria and `projectaria-tools`</h1></header><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-is-central-pupil-frame">What is Central Pupil Frame?<a href="#what-is-central-pupil-frame" class="hash-link" aria-label="Direct link to What is Central Pupil Frame?" title="Direct link to What is Central Pupil Frame?" translate="no">​</a></h2>
<p>The central pupil frame (CPF) is defined as the middle-point interpolation of the left and right nominal pupil coordinate frame in a glass. This concept has caused a lot of confusion, particularly in the ET gaze ML pipeline and other Aria calibration use cases.</p>
<p>This document provides recommendations about using CPF from a calibration perspective, specifically for Aria calibration, though the concepts can extend to other devices.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="recommendations">Recommendations<a href="#recommendations" class="hash-link" aria-label="Direct link to Recommendations" title="Direct link to Recommendations" translate="no">​</a></h2>
<ol>
<li class="">
<p>In <code>projectaria-tools</code>, you can use <code>get_T*</code>/<code>get_transform*()</code> functions to retrieve sensor extrinsics/poses. You can use the parameter <code>getCadValue</code> to switch between factory calibration value (<code>=false</code>, default) or CAD value (<code>=true</code>).</p>
</li>
<li class="">
<p><strong>Using CPF-based poses is generally not recommended</strong> because:</p>
<ul>
<li class="">When using <code>T_CPF_sensor(..., getCadValue=false)</code>, this transform from CPF (in the CAD space) to a calibrated sensor (in the calibration space) is ill-defined, and the code definition depends on implementation.</li>
<li class="">When using <code>T_CPF_sensor(getCadValue=true)</code>, this gives a well-defined pose in CAD space. However, the error in CAD space is generally much larger than calibration error if the pose is applied to real data.</li>
</ul>
</li>
<li class="">
<p><strong>We recommend using relative poses between physical sensors</strong>, e.g., pose from sensor frame 1 to sensor frame 2 (<code>T_sensor1_sensor2</code>), as the sensor-frame-based pose definition does not have the same nuances CPF-based poses have:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_sensor1_sensor2 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> T_Device_sensor1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">inverse</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> T_Device_sensor2</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="coordinate-frames-and-poses">Coordinate Frames and Poses<a href="#coordinate-frames-and-poses" class="hash-link" aria-label="Direct link to Coordinate Frames and Poses" title="Direct link to Coordinate Frames and Poses" translate="no">​</a></h2>
<p>Coordinate frames are the position and orientation of cameras and sensors. Their conventions are defined in <a class="" href="/projectaria_tools/gen2/technical-specs/coordinate/3d-coor">3D Coordinate System Conventions</a>. These are absolute concepts, such as &quot;origins being the optical center of the cameras&quot; and &quot;z-axis being the optical axis of the camera&quot;.</p>
<p>In comparison, poses are relative: they are the transforms from one coordinate frame to another.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="nuance-1-coordinate-frames-as-se3-are-actually-poses-from-an-arbitrary-reference-device-frame">Nuance 1: Coordinate frames as SE(3) are actually poses from an arbitrary reference (&quot;device&quot;) frame<a href="#nuance-1-coordinate-frames-as-se3-are-actually-poses-from-an-arbitrary-reference-device-frame" class="hash-link" aria-label="Direct link to Nuance 1: Coordinate frames as SE(3) are actually poses from an arbitrary reference (&quot;device&quot;) frame" title="Direct link to Nuance 1: Coordinate frames as SE(3) are actually poses from an arbitrary reference (&quot;device&quot;) frame" translate="no">​</a></h3>
<p>As illustrated in Figure 1, you cannot well define a coordinate frame without defining the coordinate frame where these points and vectors live. This coordinate frame is called the reference frame. So when we say &quot;pose&quot; of sensor1, we explicitly assume it is sensor1&#x27;s pose in the reference frame.</p>
<p><img decoding="async" loading="lazy" alt="Coordinate frame and pose" src="/projectaria_tools/gen2/assets/images/cpf_details_1-f5c8043f2d296be8c4793f6d43021c88.png" width="1254" height="394" class="img_ev3q"></p>
<p><em>Figure 1. Coordinate frame and pose. Coordinate frames (red) are &quot;absolute&quot; concepts; they need to be defined in a reference frame (frame1 in the diagram). Relative poses between frames are what is observable. When we say pose of frame X we are actually referring to T_frame1_frameX where frame1 being the reference frame.</em></p>
<p>In <code>projectaria-tools</code>, we define a device frame as the reference frame (and default to the left SLAM camera). So when we talk about the coordinate frame of RGB, we are actually talking about the pose of RGB relative to the device (the left SLAM camera) coordinate frame.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cad-model-and-factory-calibration">CAD Model and Factory Calibration<a href="#cad-model-and-factory-calibration" class="hash-link" aria-label="Direct link to CAD Model and Factory Calibration" title="Direct link to CAD Model and Factory Calibration" translate="no">​</a></h2>
<p>CAD models are constant, theoretical values defined by the design of the device hardware. Devices are fabricated according to the design, but with errors. A device&#x27;s factory calibration is a one-time measurement of the position of each component in the device, with the goal that:</p>
<p><strong>Calibration error MUCH SMALLER THAN CAD error</strong></p>
<p>Otherwise there&#x27;s no point doing calibration. This leads to our recommendation that, every time you use a CAD model with real data, consider why you don&#x27;t want to take advantage of the reduced error in factory calibration.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="nuance-2-t_cpf_sensorcalibration-is-not-well-defined">Nuance 2: T_CPF_sensor(calibration) is not well defined<a href="#nuance-2-t_cpf_sensorcalibration-is-not-well-defined" class="hash-link" aria-label="Direct link to Nuance 2: T_CPF_sensor(calibration) is not well defined" title="Direct link to Nuance 2: T_CPF_sensor(calibration) is not well defined" translate="no">​</a></h3>
<p>Since nominal pupil frames are the designed coordinate frame of the eyes, they only live in the CAD model. CPF, defined as the middle-interpolation of the two nominal pupil frames, therefore, also only lives in the CAD model. However, these entities are not observable during Aria calibration.</p>
<p>Now, if we need to report <code>T_CPF_sensor(calibration)</code>, this pose is a transform from the CAD model space to the calibration model space. The two model spaces are independent (just like two Aria units), and there&#x27;s no standard convention on how this alignment should be done. Therefore this pose is mathematically undefined.</p>
<p>In <code>projectaria-tools</code>, we choose to align Aria&#x27;s CAD and device calibration according to the device frame (as shown in Figure 2), therefore:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_frame1(CAD)_frame2(calibration) =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  T_frame1(CAD)_device(CAD) * T_device(calibration)_frame2(calibration)</span><br></span></code></pre></div></div>
<p>We often call this &quot;anchoring frame1 and frame2 to the device frame&quot;.</p>
<p>And <code>T_CPF_sensor</code> depends on the device frame:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_CPF_sensor(calibration) =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  T_CPF_device(CAD) * T_device_sensor(calibration)</span><br></span></code></pre></div></div>
<p>(<img decoding="async" loading="lazy" alt="CAD vs calibration alignment diagram" src="/projectaria_tools/gen2/assets/images/cpf_details_2-e12731d3dacdcc02a3962d3c081daad2.png" width="1238" height="552" class="img_ev3q">)</p>
<p><em>Figure 2. Poses between the CAD model space and the calibration model space are not well defined mathematically. Implicitly, we need to align them via device frame (according to projectaria tools implementation).</em></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="nuance-3-in-the-projectaria-tool-definition-if-switching-to-a-different-device-frame-the-value-of-t_cpf_sensor-in-the-factory-calibration-model-changes">Nuance 3: In the projectaria tool definition, if switching to a different device frame, the value of T_CPF_sensor in the factory calibration model changes<a href="#nuance-3-in-the-projectaria-tool-definition-if-switching-to-a-different-device-frame-the-value-of-t_cpf_sensor-in-the-factory-calibration-model-changes" class="hash-link" aria-label="Direct link to Nuance 3: In the projectaria tool definition, if switching to a different device frame, the value of T_CPF_sensor in the factory calibration model changes" title="Direct link to Nuance 3: In the projectaria tool definition, if switching to a different device frame, the value of T_CPF_sensor in the factory calibration model changes" translate="no">​</a></h3>
<p>Let&#x27;s say we have two definitions of <code>T_CPF_sensor</code> based on device frame1 and device frame2:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_CPF_sensor (device1) = T_CPF_device1 (CAD) * T_device1_sensor (calibration)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_CPF_sensor (device2) = T_CPF_device2 (CAD) * T_device2_sensor (calibration)</span><br></span></code></pre></div></div>
<p>As illustrated in Figure 3, the above two generally would not be the same, because generally:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">T_device1_device2 (CAD) != T_device1_device2 (calibration)</span><br></span></code></pre></div></div>
<p>Thus changing the device frame is generally accounting for the CAD model error between the two device frames. This means, if you would like to use a <code>T_CPF_sensor</code> with a sensor frame in the calibration space, you really need to be aware of what CPF means here, and it is generally a proxy of the device frame. A better choice would be staying away from CPF-based pose conventions. Rather we recommend using pose among sensor frames to be able to safely switch between CAD space and calibration space.</p>
<p><img decoding="async" loading="lazy" alt="Device frame switching diagram" src="/projectaria_tools/gen2/assets/images/cpf_details_3-8a1cf56876c2f03134aa1a9aa9b7fd58.png" width="1243" height="565" class="img_ev3q"></p>
<p><em>Figure 3. When switching device frame convention, since the pose between the two frames differ between the CAD model and the calibration model, the value T_CPF_sensor(calib) also differs.</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://www.internalfb.com/code/fbsource/arvr/projects/ariane/aria_research_kit/projectaria_tools/website/docs-technical-specs/coordinate/cpf-coor.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/projectaria_tools/gen2/technical-specs/coordinate/3d-coor"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3D Coordinate Frame Conventions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-central-pupil-frame" class="table-of-contents__link toc-highlight">What is Central Pupil Frame?</a></li><li><a href="#recommendations" class="table-of-contents__link toc-highlight">Recommendations</a></li><li><a href="#coordinate-frames-and-poses" class="table-of-contents__link toc-highlight">Coordinate Frames and Poses</a><ul><li><a href="#nuance-1-coordinate-frames-as-se3-are-actually-poses-from-an-arbitrary-reference-device-frame" class="table-of-contents__link toc-highlight">Nuance 1: Coordinate frames as SE(3) are actually poses from an arbitrary reference (&quot;device&quot;) frame</a></li></ul></li><li><a href="#cad-model-and-factory-calibration" class="table-of-contents__link toc-highlight">CAD Model and Factory Calibration</a><ul><li><a href="#nuance-2-t_cpf_sensorcalibration-is-not-well-defined" class="table-of-contents__link toc-highlight">Nuance 2: T_CPF_sensor(calibration) is not well defined</a></li><li><a href="#nuance-3-in-the-projectaria-tool-definition-if-switching-to-a-different-device-frame-the-value-of-t_cpf_sensor-in-the-factory-calibration-model-changes" class="table-of-contents__link toc-highlight">Nuance 3: In the projectaria tool definition, if switching to a different device frame, the value of T_CPF_sensor in the factory calibration model changes</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.projectaria.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Introducing Project Aria<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/projectaria_tools/gen2/">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/projectaria_tools/gen2/ark/support">Get Support</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Participate</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.projectaria.com/datasets/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open Datasets<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.projectaria.com/challenges/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Challenges<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.projectaria.com/research-kit/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partner Program<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Responsible Innovation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://about.facebook.com/realitylabs/responsible-innovation-principles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Innovation Principles<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://about.facebook.com/realitylabs/projectaria/community-guidelines/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project Aria Research Community Guidelines<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.fb.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/projectaria_tools/gen2/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/projectaria_tools/gen2/img/meta_opensource_logo_negative.svg" alt="Meta Open Source Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2025 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>