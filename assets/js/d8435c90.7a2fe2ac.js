"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[1971],{27955:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"ARK/sdk/concepts/streaming_internals","title":"Streaming Internals","description":"Overview","source":"@site/docs/ARK/sdk/concepts/streaming_internals.mdx","sourceDirName":"ARK/sdk/concepts","slug":"/ARK/sdk/concepts/streaming_internals","permalink":"/projectaria_tools/docs/ARK/sdk/concepts/streaming_internals","draft":false,"unlisted":false,"editUrl":"https://github.com/facebookresearch/projectaria_tools/tree/main/website/docs/ARK/sdk/concepts/streaming_internals.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Streaming Internals"},"sidebar":"tutorialSidebar","previous":{"title":"TICSync Time Synchronization","permalink":"/projectaria_tools/docs/ARK/sdk/samples/ticsync_sample"},"next":{"title":"Access Sensor Profiles","permalink":"/projectaria_tools/docs/ARK/sdk/concepts/sdk_sensor_profiles"}}');var n=s(74848),r=s(28453);s(98180);const a={sidebar_position:5,title:"Streaming Internals"},o="Streaming Internals",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Concepts",id:"concepts",level:2},{value:"Introduction",id:"introduction",level:3},{value:"Streaming security",id:"streaming-security",level:3},{value:"Persistent certificates",id:"persistent-certificates",level:4},{value:"Ephemeral certificates",id:"ephemeral-certificates",level:4},{value:"Streaming interfaces",id:"streaming-interfaces",level:3},{value:"Streaming over W-Fi",id:"streaming-over-w-fi",level:4},{value:"Streaming over USB",id:"streaming-over-usb",level:4},{value:"Streaming backend",id:"streaming-backend",level:3},{value:"Starting\xa0streaming",id:"startingstreaming",level:2},{value:"With the CLI",id:"with-the-cli",level:3},{value:"With the SDK",id:"with-the-sdk",level:3},{value:"Subscribing to data with the SDK",id:"subscribing-to-data-with-the-sdk",level:2},{value:"Setting up the streaming client",id:"setting-up-the-streaming-client",level:3},{value:"Message queue size",id:"message-queue-size",level:3},{value:"Adding an observer to receive data",id:"adding-an-observer-to-receive-data",level:3}];function l(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"streaming-internals",children:"Streaming Internals"})}),"\n",(0,n.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(t.p,{children:"This page provides details about how Project Aria data is streamed using the Client SDK. This is followed by how to stream and subscribe to Aria glasses\u2019 sensor streams."}),"\n",(0,n.jsx)(t.h2,{id:"concepts",children:"Concepts"}),"\n",(0,n.jsx)(t.h3,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(t.p,{children:"Project Aria glasses can be configured to stream sensor data over a network to one or more devices running the Client SDK. You can stream data from the glasses over Wi-Fi or USB."}),"\n",(0,n.jsxs)(t.p,{children:["There are two aspects to streaming; configuring the glasses to stream data and subscribing to the data. You may configure the device for streaming via the SDK, the CLI or by changing the ",(0,n.jsx)(t.a,{href:"/docs/ARK/ARK_quickstart#set-your-default-recording-profile",children:"default recording set by the Companion App"}),". During configuration, you can select a profile that determines which sensors stream data and at what rate and resolution. Once streaming has started, the glasses will start capturing data according to the set profile, but no data will be transmitted over the network until a computer running the SDK\xa0subscribes to the data."]}),"\n",(0,n.jsx)(t.p,{children:"A computer running the SDK may then subscribe to all or a subset of the sensor streams from the glasses. \xa0The device or process subscribing does not need to be the same as the device that configured the sensors or started the streaming."}),"\n",(0,n.jsx)(t.h3,{id:"streaming-security",children:"Streaming security"}),"\n",(0,n.jsx)(t.p,{children:"The sensor data streams are secured via a certificate pair. A subscribing device must have a valid certificate matching the one installed on the glasses to successfully subscribe to the sensor streams."}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsx)(t.p,{children:"Streaming certificates are not the same as the certificates used to pair the SDK with the glasses."})}),"\n",(0,n.jsxs)(t.p,{children:["You may use ",(0,n.jsx)(t.em,{children:"ephemeral"}),"\xa0or ",(0,n.jsx)(t.em,{children:"persistent"}),"\xa0streaming certificates."]}),"\n",(0,n.jsx)(t.h4,{id:"persistent-certificates",children:"Persistent certificates"}),"\n",(0,n.jsx)(t.p,{children:"Persistent certificates are generated once and are valid for a year. They may be used to subscribe to streaming data from several different computers. Persistent certificates may be generated and installed on the glasses via the CLI using:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"aria\xa0streaming\xa0install-certs\xa0\n"})}),"\n",(0,n.jsx)(t.p,{children:"Future streaming sessions will use these certificates by default. The certificates may be used on another machine by copying the certificates from the following directory to the same directory on another machine."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"~/.aria/streaming-certs/persistent\n"})}),"\n",(0,n.jsx)(t.h4,{id:"ephemeral-certificates",children:"Ephemeral certificates"}),"\n",(0,n.jsx)(t.p,{children:"Ephemeral certificates\xa0are generated on the fly for each streaming session and are only valid for that streaming session. These are most useful when you are configuring streaming and subscribing from the same machine."}),"\n",(0,n.jsx)(t.p,{children:"To start streaming with ephemeral certificates from the CLI use"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"aria\xa0streaming\xa0start *--use-ephemeral-certs*\n\n"})}),"\n",(0,n.jsx)(t.h3,{id:"streaming-interfaces",children:"Streaming interfaces"}),"\n",(0,n.jsx)(t.p,{children:"Data may be streamed over Wi-Fi or a USB network interface."}),"\n",(0,n.jsx)(t.h4,{id:"streaming-over-w-fi",children:"Streaming over W-Fi"}),"\n",(0,n.jsx)(t.p,{children:"Streaming over Wi-Fi\xa0provides more flexibility in terms of mobility, but the bandwidth and latency is dependent on the strength of the Wi-Fi connection and contention from other network users."}),"\n",(0,n.jsx)(t.h4,{id:"streaming-over-usb",children:"Streaming over USB"}),"\n",(0,n.jsx)(t.p,{children:"Streaming over USB\xa0gives higher bandwidth and a more stable connection. Since the glasses are powered over USB the duration of the streaming session is not limited by the battery. \xa0 \xa0"}),"\n",(0,n.jsx)(t.h3,{id:"streaming-backend",children:"Streaming backend"}),"\n",(0,n.jsxs)(t.p,{children:["We use ",(0,n.jsx)(t.a,{href:"https://fast-dds.docs.eprosima.com/",children:"eProsima implementation of Fast DDS"}),"\xa0to support streaming between glasses and the SDK.\nDDS enables automatic discovery of glasses over the network."]}),"\n",(0,n.jsx)(t.p,{children:"To support streaming, the following requirements must be met on the network:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Multicast UDP must be supported across the network"}),"\n",(0,n.jsx)(t.li,{children:"UDP ports in the range 7000-8000 should be open on your machine"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Each sensor stream is published over a DDS topic. If multiple Aria glasses are present on the network, a separate topic prefix should be used for each pair of glasses."}),"\n",(0,n.jsx)(t.h2,{id:"startingstreaming",children:"Starting\xa0streaming"}),"\n",(0,n.jsx)(t.h3,{id:"with-the-cli",children:"With the CLI"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.a,{href:"https://facebookresearch.github.io/projectaria_tools/docs/ARK/sdk/samples/streaming_subscribe",children:"Subscribe to Aria Streaming Data code sample"}),"\xa0shows how to initiate streaming using the CLI over USB or Wi-Fi."]}),"\n",(0,n.jsx)(t.h3,{id:"with-the-sdk",children:"With the SDK"}),"\n",(0,n.jsxs)(t.p,{children:["Setting up the glasses for streaming is configured via ",(0,n.jsx)(t.code,{children:"StreamingManager"}),". There you can configure which sensors should be streamed by setting the profile and configure the security settings for subscribing to the data."]}),"\n",(0,n.jsxs)(t.p,{children:["Go to the ",(0,n.jsx)(t.a,{href:"https://facebookresearch.github.io/projectaria_tools/docs/ARK/sdk/samples/device_stream",children:"Streaming code example"}),"\xa0for how to start streaming using the SDK."]}),"\n",(0,n.jsx)(t.h2,{id:"subscribing-to-data-with-the-sdk",children:"Subscribing to data with the SDK"}),"\n",(0,n.jsxs)(t.p,{children:["Go to ",(0,n.jsx)(t.a,{href:"https://facebookresearch.github.io/projectaria_tools/docs/ARK/sdk/samples/streaming_subscribe",children:"Subscribe to Aria Streaming Data code samples"}),"\xa0for a code walkthrough of the streaming subscription setup and configuration steps described below."]}),"\n",(0,n.jsx)(t.h3,{id:"setting-up-the-streaming-client",children:"Setting up the streaming client"}),"\n",(0,n.jsxs)(t.p,{children:["You can\xa0subscribe to data from the glasses using a ",(0,n.jsx)(t.code,{children:"StreamingClient"}),"\xa0object. If you have started streaming from the SDK you can obtain a preconfigured ",(0,n.jsx)(t.code,{children:"StreamingClient"}),"\xa0from ",(0,n.jsx)(t.code,{children:"StreamingManager"}),"\xa0using ",(0,n.jsx)(t.code,{children:"streamingManager.streamingClient()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["If you set up streaming from another CLI or another machine, you will need to set the ",(0,n.jsx)(t.code,{children:"StreamingSubscriptionConfig"})," appropriately."]}),"\n",(0,n.jsxs)(t.p,{children:["You may control which sensor streams you subscribe to using the ",(0,n.jsx)(t.code,{children:"subscriber_data_type"}),"\xa0configuration option. If you are only using a subset of the streams, this can significantly reduce the bandwidth required for stable streaming and reduce the power consumption of the glasses, extending the length of the streaming session. \xa0"]}),"\n",(0,n.jsx)(t.h3,{id:"message-queue-size",children:"Message queue size"}),"\n",(0,n.jsx)(t.p,{children:"For each data type you may set a custom queue size, controlling how many messages will be queued if the message callback is slow. The best setting for this value is application-dependent. If the processing time is bursty and it is important not to drop messages you may wish to set a long queue length. Conversely if processing is known to be slow and you are only interested in the most recent data (for example visualizing the image stream) you may wish to set the queue depth to 1."}),"\n",(0,n.jsx)(t.h3,{id:"adding-an-observer-to-receive-data",children:"Adding an observer to receive data"}),"\n",(0,n.jsx)(t.p,{children:"Streaming data is provided via callbacks on an observer object you provide to the streaming client. Please be aware that the callbacks will not be invoked from the main thread and may be invoked from a different thread from message to message. If the callback runs slowly, subsequent data on that topic will be queued up to the queue size you have configured. If the queue is full, older data will be dropped."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var i=s(96540);const n={},r=i.createContext(n);function a(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);